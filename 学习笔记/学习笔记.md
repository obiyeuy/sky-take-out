#### 后端环境搭建---nginx反向代理
将前端发送的动态请求由nginx转发到后端服务器：
* 前端请求到nginx服务器，再由nginx服务器转发到后端tomcat服务器
<br>

nginx反向代理好处：
1. 提高访问速度
2. 进行负载均衡(就是吧大量的请求按照我们指定的方式均衡的分配给集群中的每台服务器)
3. 保证后端服务安全
<br>
负载均衡策略:
![负载均衡策略.png](负载均衡策略.png)

##### 完善登陆功能
1. 修改数据库中明文密码，改为MD5加密后的密文
2. 修改Java代码，前端提交的密码进行MD5加密后再跟数据库中密码比对

##### JWT中获取id并在service中使用
![JWT.png](JWT.png)
需要用到ThreadLocal:
1. ThreadLocal并不是一个Thread，而是Thread的局部变量
2. ThreadLocal为每个线程提供单独一份存储空间，具有线程隔离的效果，只有在线程内才能获取到对应的值，线程外则不能访问
3. ThreadLocal常用方法:
   * public void set(T value) 设置当前线程的线程局部变量的值
   * public T get()   返回当前线程所对应的线程局部变量的值
   * public void remove()  移除当前线程的线程局部变量
   
##### 日期以数组的形式发送，展现时有问题的解决办法
1. 在属性上加入注解，对日期进行格式化
<br>
   @JsonFormat(pattern = "yyyy-MM-dd HH:mm:ss")
<br>
   private LocalDateTime updateTime;
2. 在WebMvcConfiguration中扩展Spring MVC的消息转换器，统一对日期类型进行格式化处理

##### 公共字段自动填充
1. 问题分析：如create_time、create_user...等属于业务表中的公共字段，每个业务都需要赋值，比较繁琐。造成代码冗余，不便于后期维护的问题
2. 实现思路：先看字段的操作类型，如create_time是insert时，update_user是insert与update时
3. 操作思路：统一处理，使用切面
   * 自定义注解AutoFill，用于标识需要进行公共字段自动填充的方法
   * 自定义切面类AutoFillAspect，统一拦截加入了AutoFill注解的方法，通过反射为公共字段赋值
   * 在Mapper的方法上加入AutoFill注解
   * 技术点：枚举、注解、AOP、反射

##### Redis
1. Redis入门:
   * 基于内存的key—value结构数据库
     * 基于内存存储，读写性能会更高
     * 适合存储热点数据(热点商品、资讯、新闻)
     * 企业应用广泛
   * 官网:
     * https://redis.io    
     * https://www.redis.net.cn/
   * Redis服务的启动与停止
     * 服务启动:在安装目录下进入命令行,输入:redis-server.exe redis.windows.conf
     * 服务停止:在安装目录下进入命令行,输入ctrl+C
     * 客户端启动:在安装目录下进入命令行,输入redis-cli.exe -h localhost -p 6379 -a password即可(也可以先进入，再输入auth password)
2. Redis数据类型(key-value结构，其中key是字符串类型，value有五种常用的数据类型)
   * 字符串 string
   * 哈希 hash
   * 列表 list
   * 集合 set
   * 有序集合 sorted set/zset
     
![Redis数据类型特点.png](Redis数据类型特点.png)
3. Redis常用命令
* 字符串操作命令
   
| 操作命令                   | 命令内涵                           | 
|------------------------|--------------------------------|
| SET key value          | 设置指定key的值                      |
| GET key                | 获取指定key的值                      |
| SETEX key seconds value | 设置指定key的值，并将key的过期时间设为seconds秒 |
| SETEX key value        | 只有在key不存在时设置key的值              |

  * 哈希操作命令
    * Redis hash是一个string类型的field和value的映射表，hash特别适合用于存储对象

| 操作命令                 | 命令内涵                      |
|----------------------|---------------------------|
| HSET key field value | 将哈希表key中的字段field的值设为value |
| HGET key field       | 获取存储在哈希表中指定字段的值           |
| HDEL key field       | 删除存储在哈希表中的指定字段            |
| HKEYS key            | 获取哈希表中所有字段                |
| HVALS key            | 获取哈希表中所有值                 |

* 列表操作命令
    * Redis列表是简单的字符串列表，按照插入顺序排序
  
| 操作命令                      | 命令内涵              |
|---------------------------|-------------------|
| LPUSH key value1 [value2] | 将一个或多个值插入到列表头部(左边) |
| LRANGE key start stop     | 获取列表指定范围内的元素      |
| RPOP key                  | 移除并获取列表最后一个元素(右边) |
| LLEN key                  | 获取列表长度            |

* 集合操作命令
Redis set是string类型的无序集合，集合成员是唯一的，集合中不能出现重复的数据

| 操作命令                       | 命令内涵        |
|----------------------------|-------------|
| SADD key member1 [member2] | 向集合添加一个或多个成员 |
| SMEMBERS key               | 返回集合中的所有成员  |
| SCARD key                  | 获取集合的成员数    |
| SINTER key1 [key2]         | 返回给定所有集合的交集 |
| SUNION key1 [key2]         | 返回所有给定集合的并集 |
| SREM key member1 [member2] | 删除集合中一个或多个成员 |

* 有序集合操作命令
    * Redis有序集合是string类型元素的集合，且不允许有重复成员。每个元素都会关联一个double类型的分数

| 操作命令                                     | 命令内涵                       |
|------------------------------------------|----------------------------|
| ZADD key score1 member1 [score2 member2] | 向有序集合添加一个或多个成员             |
| ZRANGE key start stop [WITHSCORES]       | 通过索引区间返回有序集合中指定区间内的成员      |
| ZINCRBY key increment member             | 有序集合中对指定成员的分数加上增量increment |
| ZREM key member                          | 移除有序集合中的一个或多个成员            |

* 通用命令
    * Redis的通用命令是不分数据类型的，都可以使用的命令

| 操作命令         | 命令内涵                    |
|--------------|-------------------------|
| KEYS pattern | 查找所有符合给定模式(pattern)的key |
| EXISTS key   | 检查给定key是否存在             |
| TYPE key     | 返回key所存储的值的类型           |
| DEL key      | 该命令用于在key存在是删除key       |

4. 在Java中操作Redis
    * Redis的Java客户端很多，常用的有:
      * Jedis:官方推荐
      * Lettuce:性能是否高效
      * Spring Data Redis:是Spring的一部分，对Redis底层开发包进行了高度封装
    * Spring Data Redis使用方式
      * 导入Spring Data Redis的maven坐标
      * 配置Redis数据源
      * 编写配置类，创建RedisTemplate对象
      * 通过RedisTemplate对象操作Redis
